<html>
<head>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.5.4/dist/aframe-extras.min.js"></script>
    <script>
        
    // ΕΔΩ ΤΟΠΟΘΕΤΩ ΤΑ ΣΥΣΤΑΤΙΚΑ (COMPONENTS) ΠΟΥ ΕΧΩ ΔΗΜΙΟΥΡΓΗΣΕΙ
    </script>
    <style>
        h1 { text-align: center; }
        h3 { text-align: center; }
        a-scene { width: 50%; height: 50%; border: dotted RosyBrown 5px; }
    </style>
</head>
<body>
    <h1>Chicken Run</h1>
    <h3>Σοφία Κόντη</h3>
    <hr />
    <P><strong>Οι κότες το έσκασαν και κρύβονται στο δάσος! Χρησιμοποίησε τα εργαλία που θα βρείς στην αποθήκη με τον κατάλληλο τρόπο, έτσι ώστε να πιάσεις τις κότες και να τις μαζέψεις ξανά στο κοτέτσι τους</strong>...</P>
    <hr />
    <div align="center">
   
    <!-- ΕΔΩ ΠΕΡΙΓΡΑΦΩ ΤΗ ΣΚΗΝΗ -->
      <a-scene id="s1" cursor="rayOrigin: mouse" background="color:LightBlue" shadow="type: pcfsoft" ondblclick="this.requestFullscreen();"embedded>
          <a-camera><a-cursor fuse="true" fuse-timeout="5000"></a-cursor></a-camera>
          <a-light type="ambient" color="#ccc"></a-light>
          <a-light type="directional" position="0 10 0" intensity="0.5"></a-light>
          <a-plane color="DarkOliveGreen" height="500" width="500" rotation="-90 0 0" metalness="0" shadow></a-plane>
          <a-sphere color="GoldenRod" radius="500" position="0 5000 0" material="fog: false"></a-sphere>
          <a-assets>
              <a-asset-item id="spruce_tree" src="spruce_tree.glb"></a-asset-item>
              <a-asset-item id="little_farmhouse" src="little_farmhouse.glb"></a-asset-item>
              <a-asset-item id="colored_flower" src="colored_flower.glb"></a-asset-item>
              <a-asset-item id="baby_chicken" src="baby_chicken.glb"></a-asset-item>
              </a-assets>
          <a-entity gltf-model="#little_farmhouse" scale="0.5 0.5 0.5" position="1 1 1"></a-entity>
        </a-scene>
    </div>

<script>
AFRAME.registerComponent('chicken-behavior', {
  schema: {
    coop: { type: 'vec3' }
  },
  init: function () {
    this.caught = false;
    this.camera = document.querySelector('a-camera').object3D;
    this.teleported = false;
  },
  tick: function (time, delta) {
    if (this.caught && !this.teleported) {
      // Απόκρυψη
      this.el.setAttribute('visible', false);

      // Νέα θέση: κοντά στο κοτέτσι (τυχαία μικρή μετατόπιση)
      const offsetX = (Math.random() - 0.5) * 4;
      const offsetZ = (Math.random() - 0.5) * 4;
      const newX = this.data.coop.x + offsetX;
      const newZ = this.data.coop.z + offsetZ;

      // Νέα τοποθέτηση
      this.el.setAttribute('position', `${newX} 0 ${newZ}`);
      
      // Εμφάνιση
      this.el.setAttribute('visible', true);

      this.teleported = true;
    }

    if (this.caught) return;

    const chickenPos = this.el.object3D.position;
    const playerPos = this.camera.position;
    const distance = chickenPos.distanceTo(playerPos);

    if (distance < 1.2) {
      this.caught = true;
    } else if (distance < 3) {
      const dir = new THREE.Vector3().subVectors(chickenPos, playerPos).normalize();
      this.el.object3D.translateOnAxis(dir, 1 * delta / 1000);
      this.el.object3D.lookAt(playerPos);
    }
  }
});
</script>


    
    
<script>
  AFRAME.registerComponent('random-walk', {
    schema: {
      speed: { type: 'number', default: 0.2 },
      range: { type: 'number', default: 10 }
    },
    init: function () {
      this.target = new THREE.Vector3();
      this.chooseNewTarget();
    },
    tick: function (time, delta) {
      const el = this.el.object3D;
      const pos = el.position;
      const dir = new THREE.Vector3().subVectors(this.target, pos).normalize();
      const dist = pos.distanceTo(this.target);
      if (dist < 0.5) this.chooseNewTarget();
      el.translateOnAxis(dir, this.data.speed * delta / 1000);
      el.lookAt(this.target);
    },
    chooseNewTarget: function () {
      const current = this.el.object3D.position;
      const x = current.x + (Math.random() * this.data.range - this.data.range / 2);
      const z = current.z + (Math.random() * this.data.range - this.data.range / 2);
      this.target.set(x, 0, z);
    }
  });

  // ΜΕΤΑ την A-Scene
  window.addEventListener('load', () => {
    const scene1 = document.getElementById('s1');

    for (let i = 0; i < 5; i++) {
      const chicken = document.createElement('a-entity');
      const x = Math.random() * 400 - 200;
      const z = Math.random() * 400 - 200;

      chicken.setAttribute('gltf-model', '#baby_chicken');
      chicken.setAttribute('position', `${x} 0 ${z}`);
      chicken.setAttribute('scale', '0.1 0.1 0.1');
      chicken.setAttribute('animation-mixer', 'clip: *; loop: repeat');
      chicken.setAttribute('random-walk', 'speed: 0.2; range: 10');
      chicken.setAttribute('chicken-behavior', 'coop: 1 0 1'); 

      scene1.appendChild(chicken);
    }
  });
</script>


    
    <script>     
    
    // ΕΔΩ ΔΗΜΙΟΥΡΓΩ ΠΟΛΛΑΠΛΑ ΑΝΤΙΓΡΑΦΑ ΜΙΑΣ ΟΝΤΟΤΗΤΑΣ
        var scene1 = document.getElementById('s1');
        for(var i = 0; i < 400; i++) {
        var tree = document.createElement('a-entity');
        var x = Math.random() * 400 - 200;
        var z = Math.random() * 400 - 200;
        var s = 0.01;
        var r = Math.random() * 180 - 90;
        tree.setAttribute('gltf-model', '#spruce_tree');
        tree.setAttribute('position', x + ' 0 ' + z);
        tree.setAttribute('scale', s + ' ' + s + ' ' + s);
        tree.setAttribute('rotation', '0 ' + r + ' 0');
        scene1.appendChild(tree);
      }
      for (var i = 0; i < 200; i++) {
      var flowers = document.createElement('a-entity');
      var x = Math.random() * 400 - 200;
      var z = Math.random() * 400 - 200;
      var s = 0.03;
      var r = Math.random() * 180 - 90;
      flowers.setAttribute('gltf-model', '#colored_flower');
      flowers.setAttribute('position', x + ' 0 ' + z);
      flowers.setAttribute('scale', s + ' ' + s + ' ' + s);
      flowers.setAttribute('rotation', '0 ' + r + ' 0');
      flowers.setAttribute('shadow', 'receive: false');  
      scene1.appendChild(flowers);
      }
    </script>
    <hr />
    <p><strong>Οδηγίες:<strong>...</p>
    <hr />
    <p><strong>Credits:</strong></p>
    </strong>
</body>
</html>

